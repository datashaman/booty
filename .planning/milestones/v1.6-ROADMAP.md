# Milestone v1.6: Memory Agent

**Status:** ✅ SHIPPED 2026-02-16
**Phases:** 22–26
**Total Plans:** 12

## Overview

Memory Agent converts high-value system events into durable, queryable knowledge and surfaces that knowledge back into the workflow as context. Informational only — no outcomes are blocked or altered. Deterministic lookup by fingerprint/paths (no embeddings in v1); append-only storage (.booty/state/memory.jsonl), 90-day retention, configurable.

## Phases

### Phase 22: Memory Foundation ✓

**Goal:** Storage, schema, config, add_record API, dedup.

**Depends on:** Nothing

**Plans:** 3 plans

- [x] 22-01: MemoryConfig schema (.booty.yml memory block, env overrides)
- [x] 22-02: MemoryRecord schema, append-only store (memory.jsonl, atomic writes, fsync)
- [x] 22-03: add_record API with dedup (type, repo, sha, fingerprint, pr_number) 24h window

**Requirements:** MEM-01, MEM-02, MEM-03, MEM-04, MEM-05, MEM-13, MEM-14, MEM-24, MEM-25, MEM-26

---

### Phase 23: Ingestion ✓

**Goal:** Wire adapters from Observability, Governor, Security, Verifier, Revert.

**Depends on:** Phase 22

**Plans:** 4 plans

- [x] 23-01: Memory adapters (build_*_record for incident, governor_hold, deploy_failure, security_block, verifier_cluster, revert)
- [x] 23-02: Webhook ingestion (Observability, Governor HOLD, Deploy failure)
- [x] 23-03: Security + Verifier wiring (FAIL/ESCALATE, failure classes)
- [x] 23-04: Revert (CLI ingest revert, push handler on main)

**Requirements:** MEM-06, MEM-07, MEM-08, MEM-09, MEM-10, MEM-11, MEM-12

---

### Phase 24: Lookup ✓

**Goal:** Deterministic query engine by paths, fingerprint, ecosystem.

**Depends on:** Phase 22

**Plans:** 1 plan

- [x] 24-01: Lookup query engine (path/fingerprint match, sort by severity/recency, retention filter, result subset)

**Requirements:** MEM-15, MEM-16, MEM-17, MEM-18

---

### Phase 25: Surfacing ✓

**Goal:** Surface context in Builder PR, Governor HOLD, Observability incident.

**Depends on:** Phase 24

**Plans:** 3 plans

- [x] 25-01: PR comment "Memory: related history" on Verifier check_run completion (marker `<!-- booty-memory -->`)
- [x] 25-02: Governor HOLD — surface 1–2 fingerprint matches in PR comment
- [x] 25-03: Observability incident — "Related history" section in build_sentry_issue_body

**Requirements:** MEM-19, MEM-20, MEM-21, MEM-22, MEM-23

---

### Phase 26: CLI ✓

**Goal:** booty memory status and booty memory query.

**Depends on:** Phase 22, Phase 24

**Plans:** 1 plan

- [x] 26-01: booty memory status | query --pr N | --sha SHA (MEM-27, MEM-28)

**Requirements:** MEM-27, MEM-28

---

## Milestone Summary

**Key Decisions:**

- Memory block kept as raw dict; MemoryConfig validates on use (MEM-25)
- Trigger on check_run completed (not pull_request) — Memory surfaces only after Verifier runs
- Governor section merges into existing Memory comment (append or replace)
- Stdlib only for lookup; no new deps; verifier_cluster derives paths_hash from candidate paths

**Issues Resolved:**

- None — all phases executed as planned

**Technical Debt Incurred:**

- None reported

---

_For current project status, see .planning/ROADMAP.md_

---

*Archived: 2026-02-16 as part of v1.6 milestone completion*
