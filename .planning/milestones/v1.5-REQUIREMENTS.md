# Requirements Archive: v1.5 Security Agent

**Archived:** 2026-02-16
**Status:** ✅ SHIPPED

This is the archived requirements specification for v1.5.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone via `/gsd:new-milestone`).

---

# Requirements: Booty — Milestone v1.5 Security Agent

**Defined:** 2026-02-16
**Core Value:** A Builder agent that can take a GitHub issue and produce a working PR with tested code — the foundation everything else builds on.

## v1.5 Requirements

Security Agent: merge veto authority. Verifier answers "Does it work?" — Security answers "Could this harm us?"

### Secret Detection

- [x] **SEC-01**: Security agent runs on `pull_request` opened and synchronize
- [x] **SEC-02**: Security publishes required GitHub check `booty/security`
- [x] **SEC-03**: Security scans changed files only for secrets (gitleaks preferred; trufflehog acceptable)
- [x] **SEC-04**: When secret detected: check FAIL, annotate file+line, title "Security failed — secret detected", cap 50 annotations

### Dependency Vulnerability

- [x] **SEC-05**: Security auto-detects ecosystem via lockfiles (pip, npm, composer, cargo)
- [x] **SEC-06**: Security runs appropriate audit tool (pip-audit, npm audit, composer audit, cargo audit)
- [x] **SEC-07**: Security FAILs check only when severity >= HIGH; ignore low/medium

### Permission Drift

- [x] **SEC-08**: Security watches sensitive paths (`.github/workflows/**`, `infra/**`, `terraform/**`, `helm/**`, `k8s/**`, `iam/**`, `auth/**`, `security/**`)
- [x] **SEC-09**: When sensitive path touched: result ESCALATE (not FAIL), override deploy risk to HIGH, reason `permission_surface_change`
- [x] **SEC-10**: Governor consumes Security risk override before deploy decisions
- [x] **SEC-11**: Security does NOT fail PR on permission drift — only escalates to Governor

### Configuration

- [x] **SEC-12**: Extend .booty.yml with `security` block: `enabled`, `fail_severity`, `sensitive_paths`
- [x] **SEC-13**: Unknown keys in security block fail config load (extra='forbid')
- [x] **SEC-14**: Env overrides: `SECURITY_ENABLED`, `SECURITY_FAIL_SEVERITY`

### Check UX

- [x] **SEC-15**: Check name `booty/security`
- [x] **SEC-16**: Clear titles only: "Security failed — secret detected", "Security failed — critical vulnerability", "Security escalated — workflow modified"

### Performance

- [x] **SEC-17**: Security check completes in under 60 seconds (diff-only scanning, parallelize when safe)

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| SEC-01 | 18 | Complete |
| SEC-02 | 18 | Complete |
| SEC-12 | 18 | Complete |
| SEC-13 | 18 | Complete |
| SEC-14 | 18 | Complete |
| SEC-15 | 18 | Complete |
| SEC-16 | 18 | Complete |
| SEC-03 | 19 | Complete |
| SEC-04 | 19 | Complete |
| SEC-17 | 19 | Complete |
| SEC-05 | 20 | Complete |
| SEC-06 | 20 | Complete |
| SEC-07 | 20 | Complete |
| SEC-08 | 21 | Complete |
| SEC-09 | 21 | Complete |
| SEC-10 | 21 | Complete |
| SEC-11 | 21 | Complete |

**Coverage:**
- v1.5 requirements: 17 total
- Mapped to phases: 17
- Shipped: 17/17 ✓

---

## Milestone Summary

**Shipped:** 17 of 17 v1.5 requirements

**Adjusted:** None — all requirements delivered as specified.

**Dropped:** None.

---

*Archived: 2026-02-16 as part of v1.5 milestone completion*
