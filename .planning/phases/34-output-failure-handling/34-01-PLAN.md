---
phase: 34-output-failure-handling
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/booty/architect/output.py
  - tests/test_architect_output.py
autonomous: true

must_haves:
  truths:
    - Architect produces ArchitectPlan with plan_version, goal, steps, touch_paths, risk_level, handoff_to_builder, architect_notes
    - architect_notes is optional and not consumed by Builder
  artifacts:
    - path: src/booty/architect/output.py
      provides: ArchitectPlan, build_architect_plan
      exports: ["ArchitectPlan", "build_architect_plan"]
  key_links:
    - from: ArchitectPlan
      to: Plan
      via: build_architect_plan maps Plan fields
      pattern: plan_version|goal|steps|touch_paths
---

<objective>
Introduce ArchitectPlan structured output (ARCH-16, ARCH-17).

Purpose: Architect produces ArchitectPlan for Builder handoff (Phase 36) and comment display. architect_notes optional.
Output: ArchitectPlan dataclass, build_architect_plan(plan, notes).
</objective>

<execution_context>
@/Users/marlinf/.claude/get-shit-done/workflows/execute-plan.md
@/Users/marlinf/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/milestones/v1.8-ROADMAP.md
@.planning/REQUIREMENTS.md
@.planning/phases/34-output-failure-handling/34-CONTEXT.md
@.planning/phases/34-output-failure-handling/34-RESEARCH.md
@src/booty/planner/schema.py
@src/booty/architect/worker.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: ArchitectPlan dataclass and build_architect_plan</name>
  <files>src/booty/architect/output.py</files>
  <action>
1. Create src/booty/architect/output.py:
   - ArchitectPlan: dataclass or Pydantic model with plan_version (str), goal (str), steps (list[Step]), touch_paths (list[str]), risk_level (Literal["LOW","MEDIUM","HIGH"]), handoff_to_builder (HandoffToBuilder), architect_notes (str | None). Per ARCH-16. Use Plan, Step, HandoffToBuilder from planner.schema.
   - build_architect_plan(plan: Plan, architect_notes: str | None = None) -> ArchitectPlan: maps plan fields; architect_notes optional per ARCH-17.
2. Export ArchitectPlan, build_architect_plan from architect/output.py. Add architect/__init__.py export if needed.
</action>
  <verify>python -c "
from booty.architect.output import ArchitectPlan, build_architect_plan
from booty.planner.schema import Plan, Step, HandoffToBuilder
p = Plan(goal='x', steps=[Step(id='P1', action='read', path='f', acceptance='ok')], handoff_to_builder=HandoffToBuilder(branch_name_hint='b', commit_message_hint='c', pr_title='t', pr_body_outline='o'))
ap = build_architect_plan(p, 'note')
assert ap.plan_version == '1' and ap.goal == 'x' and ap.architect_notes == 'note'
ap2 = build_architect_plan(p)
assert ap2.architect_notes is None
print('OK')
"</verify>
  <done>ArchitectPlan and build_architect_plan exist; architect_notes optional</done>
</task>

<task type="auto">
  <name>Task 2: Tests for ArchitectPlan</name>
  <files>tests/test_architect_output.py</files>
  <action>
Add tests/test_architect_output.py:
- test_build_architect_plan_maps_fields: assert all Plan fields map to ArchitectPlan
- test_build_architect_plan_architect_notes_optional: with notes, without notes
</action>
  <verify>pytest tests/test_architect_output.py -v</verify>
  <done>Tests pass</done>
</task>

</tasks>

<verification>
- ArchitectPlan has plan_version, goal, steps, touch_paths, risk_level, handoff_to_builder, architect_notes
- build_architect_plan(plan, None) produces ArchitectPlan with architect_notes=None
</verification>

<success_criteria>
- ArchitectPlan dataclass/model in output.py
- build_architect_plan(plan, notes?) returns ArchitectPlan
- Tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/34-output-failure-handling/34-01-SUMMARY.md`
</output>
