---
phase: 14-governor-foundation-persistence
plan: 03
type: execute
wave: 2
depends_on: ["01", "02"]
files_modified:
  - src/booty/release_governor/handler.py
  - src/booty/release_governor/__init__.py
  - src/booty/cli.py
autonomous: true

must_haves:
  truths:
    - "booty governor status shows release state when Governor enabled"
    - "booty governor status shows disabled when release_governor absent or enabled=false"
    - "Handler stubs exist with Phase 15 signature (no-op)"
  artifacts:
    - path: src/booty/release_governor/handler.py
      provides: Placeholder handler stubs
    - path: src/booty/cli.py
      provides: governor subcommand group, status command
  key_links:
    - from: cli governor status
      to: release_governor config + store
      via: load config, load state, print
      pattern: load_release_state|load_booty_config
---

<objective>
Create Governor module skeleton with placeholder handlers and booty governor status CLI.

Purpose: GOV-30 — New agent module release_governor; minimal CLI for operator visibility.

Output: handler.py stubs, governor subcommand with status.
</objective>

<execution_context>
@/Users/marlinf/.claude/get-shit-done/workflows/execute-plan.md
@/Users/marlinf/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-governor-foundation-persistence/14-CONTEXT.md
@.planning/phases/14-governor-foundation-persistence/14-RESEARCH.md
@src/booty/cli.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create handler stubs and governor subcommand</name>
  <files>src/booty/release_governor/handler.py, src/booty/cli.py</files>
  <action>
1. Create handler.py with placeholder function(s) matching Phase 15 workflow_run handler signature. E.g. async def handle_workflow_run(payload: dict) -> None: pass. Docstring: "Phase 15 implements workflow_run handling; this is a no-op stub."

2. Add @cli.group() def governor(): for governor subcommand group (similar to verifier).

3. Add @governor.command() def status(): Load BootyConfig from current dir .booty.yml (use load_booty_config(Path.cwd())). If release_governor is None or not enabled (apply env overrides first), print "Governor: disabled" and return. If enabled: get state_dir from get_state_dir(), load_release_state(state_dir), print production_sha_current, production_sha_previous, last_deploy_attempt_sha, last_deploy_time, last_deploy_result, last_health_check in readable format (e.g. table or key: value lines). Handle missing .booty.yml (FileNotFoundError or default) gracefully — show disabled.
  </action>
  <verify>cd /Users/marlinf/Projects/datashaman/booty && booty governor status 2>&1 | head -5</verify>
  <done>booty governor status runs; shows disabled or state when enabled</done>
</task>

<task type="auto">
  <name>Task 2: Wire handler module and ensure is_enabled helper</name>
  <files>src/booty/release_governor/__init__.py</files>
  <action>
Add is_governor_enabled(config: BootyConfigV1) -> bool helper: returns config.release_governor is not None and apply_release_governor_env_overrides(config.release_governor).enabled. Export from __init__.py. Update handler and CLI to use this for enabled check.
  </action>
  <verify>python -c "from booty.release_governor import is_governor_enabled; from booty.test_runner.config import load_booty_config_from_content; c = load_booty_config_from_content('schema_version: 1\ntest_command: p\nrelease_governor:\n  enabled: true'); assert is_governor_enabled(c) is True"</verify>
  <done>is_governor_enabled correctly reflects config + env</done>
</task>

</tasks>

<verification>
- booty governor status exists and runs
- When release_governor in .booty.yml with enabled: true, status shows state
- When disabled, status shows "Governor: disabled"
- Handler stubs exist for Phase 15
</verification>

<success_criteria>
- [ ] governor status command works
- [ ] Handler stubs with Phase 15 signature
- [ ] is_governor_enabled helper
</success_criteria>

<output>
After completion, create `.planning/phases/14-governor-foundation-persistence/14-03-SUMMARY.md`
</output>
