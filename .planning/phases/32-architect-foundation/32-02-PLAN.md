---
phase: 32-architect-foundation
plan: 02
type: execute
wave: 2
depends_on: ['01']
files_modified:
  - src/booty/architect/input.py
  - src/booty/architect/worker.py
autonomous: true

must_haves:
  truths:
    - Architect receives plan_json, normalized_input, optional repo_context, optional issue_metadata
    - Architect operates when repo_context is missing
    - process_architect_input returns approved status (pass-through in Phase 32)
  artifacts:
    - path: src/booty/architect/input.py
      provides: ArchitectInput
    - path: src/booty/architect/worker.py
      provides: ArchitectResult, process_architect_input
  key_links:
    - from: ArchitectInput
      to: Plan
      via: plan field
      pattern: plan.*Plan
    - from: ArchitectInput
      to: PlannerInput
      via: normalized_input field
      pattern: normalized_input
---

<objective>
Architect input ingestion and module skeleton.

Purpose: Architect receives plan_json, normalized_input, optional repo_context, optional issue_metadata. Phase 32: process_architect_input is pass-through (approved=True when config.enabled); full validation is Phase 33. Architect operates when repo_context is missing (ARCH-05).
Output: ArchitectInput, ArchitectResult, process_architect_input.
</objective>

<execution_context>
@/Users/marlinf/.claude/get-shit-done/workflows/execute-plan.md
@/Users/marlinf/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/32-architect-foundation/32-CONTEXT.md
@.planning/phases/32-architect-foundation/32-RESEARCH.md
@src/booty/planner/input.py
@src/booty/planner/schema.py
@src/booty/architect/config.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: ArchitectInput and ArchitectResult</name>
  <files>src/booty/architect/input.py, src/booty/architect/worker.py</files>
  <action>
1. Create src/booty/architect/input.py:
   - ArchitectInput: plan (Plan | dict), normalized_input (PlannerInput), repo_context (dict | None = None), issue_metadata (dict | None = None). Uses Plan from planner.schema and PlannerInput from planner.input. Per ARCH-04.

2. Create src/booty/architect/worker.py:
   - ArchitectResult: approved (bool), plan (Plan | dict), architect_notes (str | None = None). Per ARCH-16/17.
   - process_architect_input(config: ArchitectConfig, inp: ArchitectInput) -> ArchitectResult:
     - Phase 32: pass-through. If config.enabled: return ArchitectResult(approved=True, plan=inp.plan, architect_notes=None). If not enabled: same (caller handles enabled check). Actually per CONTEXT, enabled=False means pass-through at Planner worker (skip Architect, enqueue Builder). So process_architect_input is only called when config.enabled. For Phase 32, just return approved=True with same plan.
     - Ensure it works when repo_context is None (ARCH-05).
  </action>
  <verify>python -c "
from booty.architect.config import ArchitectConfig
from booty.architect.input import ArchitectInput
from booty.architect.worker import process_architect_input, ArchitectResult
from booty.planner.schema import Plan
from booty.planner.input import PlannerInput

plan = Plan(goal='test', steps=[], handoff_to_builder=dict(branch_name_hint='x', commit_message_hint='y', pr_title='z', pr_body_outline='w'))
norm = PlannerInput(goal='test', body='')
inp = ArchitectInput(plan=plan, normalized_input=norm, repo_context=None, issue_metadata=dict(issue_number=1))
config = ArchitectConfig(enabled=True)
r = process_architect_input(config, inp)
assert r.approved is True
assert r.plan is plan
assert r.architect_notes is None
"</verify>
  <done>ArchitectInput and ArchitectResult defined; process_architect_input returns pass-through approved</done>
</task>

<task type="auto">
  <name>Task 2: Operate when repo_context is missing</name>
  <files>src/booty/architect/worker.py</files>
  <action>
process_architect_input must not require repo_context. ArchitectInput.repo_context defaults to None. No logic in process_architect_input that assumes repo_context is present. Phase 33 will add architect_notes when repo_context was missing; Phase 32 just accepts None.
  </action>
  <verify>python -c "
from booty.architect.config import ArchitectConfig
from booty.architect.input import ArchitectInput
from booty.architect.worker import process_architect_input
from booty.planner.schema import Plan
from booty.planner.input import PlannerInput

plan = Plan(goal='x', steps=[], handoff_to_builder=dict(branch_name_hint='a', commit_message_hint='b', pr_title='c', pr_body_outline='d'))
inp = ArchitectInput(plan=plan, normalized_input=PlannerInput(goal='x', body=''), repo_context=None)
r = process_architect_input(ArchitectConfig(), inp)
assert r.approved is True
"</verify>
  <done>Architect operates when repo_context is None</done>
</task>

</tasks>

<verification>
- ArchitectInput accepts plan, normalized_input, repo_context=None, issue_metadata=None
- process_architect_input returns approved=True with same plan (Phase 32 pass-through)
- Works with repo_context=None
</verification>

<success_criteria>
- Architect receives plan_json, normalized_input, optional repo_context, optional issue_metadata (ARCH-04, ARCH-05)
- process_architect_input exists and returns ArchitectResult
- Phase 32 pass-through: approved=True
</success_criteria>

<output>
After completion, create .planning/phases/32-architect-foundation/32-02-SUMMARY.md
</output>
